(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8721],{12181:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(71847).A)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},39444:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>A});var l=a(95155),r=a(12115),t=a(20063),i=a(86948),n=a(3998),c=a(65142),o=a(76444),d=a(11186),m=a(18332),h=a(33667),x=a(35626),p=a(61362),u=a(20508),j=a(12181),v=a(17910),N=a(68854),g=a(21873),w=a(70532),f=a(57828),b=a(65229),y=a(46046);let A=()=>{let e=(0,t.useRouter)(),[s,a]=(0,r.useState)(!1),[A,C]=(0,r.useState)(!1),[k,P]=(0,r.useState)(!1),[I,F]=(0,r.useState)(!1),[E,S]=(0,r.useState)([]),[J,q]=(0,r.useState)(!0),[U,L]=(0,r.useState)({fullname:"",phone:"",email:"",role:"Normal",locationId:"",isActive:!0,avatar:"",password:"",confirmPassword:""}),[O,R]=(0,r.useState)({});r.useEffect(()=>{(async()=>{try{let e=await fetch("/api/locations?limit=100",{cache:"no-store"});if(!e.ok)throw Error("Failed to fetch locations");let s=await e.json();S(s.locations||[])}catch(e){console.error("Error fetching locations:",e),S([])}finally{q(!1)}})()},[]);let T=(e,s)=>{L(a=>({...a,[e]:s})),O[e]&&R(s=>({...s,[e]:""}))},$=async s=>{if(s.preventDefault(),(()=>{let e={};return U.fullname.trim()||(e.fullname="Full name is required"),U.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(U.email)||(e.email="Please enter a valid email address"):e.email="Email is required",U.phone.trim()||(e.phone="Phone number is required"),U.locationId&&"loading"!==U.locationId&&"no-locations"!==U.locationId||(e.locationId="Location is required"),U.password?U.password.length<8&&(e.password="Password must be at least 8 characters long"):e.password="Password is required",U.password!==U.confirmPassword&&(e.confirmPassword="Passwords do not match"),R(e),0===Object.keys(e).length})()){a(!0);try{if(!U.locationId||"loading"===U.locationId||"no-locations"===U.locationId){R({locationId:"Please select a valid location"}),a(!1);return}if(!E.find(e=>e.id===U.locationId)){R({locationId:"Selected location not found"}),a(!1);return}let s=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullname:U.fullname,phone:U.phone,email:U.email,role:U.role,locationId:U.locationId,isActive:U.isActive,avatar:U.avatar||void 0,password:U.password})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to create user")}let l=await s.json();console.log("Created user:",l),C(!0),setTimeout(()=>{e.push("/admin/users")},2e3)}catch(e){console.error("Failed to create user:",e)}finally{a(!1)}}};return(0,l.jsx)("div",{className:"min-h-screen bg-background",children:(0,l.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,l.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>e.push("/admin/users"),className:"p-2",children:(0,l.jsx)(x.A,{className:"h-4 w-4"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Add New User"}),(0,l.jsx)("p",{className:"text-muted-foreground mt-2",children:"Create a new user account in the system"})]})]})}),A&&(0,l.jsxs)(m.Fc,{className:"mb-6 border-green-200 bg-green-50",children:[(0,l.jsx)(p.A,{className:"h-4 w-4 text-green-600"}),(0,l.jsx)(m.TN,{className:"text-green-800",children:"User created successfully! Redirecting to user list..."})]}),(0,l.jsxs)("form",{onSubmit:$,children:[(0,l.jsxs)(i.Zp,{children:[(0,l.jsx)(i.aR,{children:(0,l.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,l.jsx)(u.A,{className:"h-5 w-5"}),"User Information"]})}),(0,l.jsxs)(i.Wu,{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"fullname",children:"Full Name *"}),(0,l.jsx)(c.p,{id:"fullname",placeholder:"Enter full name",value:U.fullname,onChange:e=>T("fullname",e.target.value),className:O.fullname?"border-red-500":""}),O.fullname&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:O.fullname})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"email",children:"Email Address *"}),(0,l.jsx)(c.p,{id:"email",type:"email",placeholder:"Enter email address",value:U.email,onChange:e=>T("email",e.target.value),className:O.email?"border-red-500":""}),O.email&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:O.email})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"phone",children:"Phone Number *"}),(0,l.jsx)(c.p,{id:"phone",placeholder:"Enter phone number",value:U.phone,onChange:e=>T("phone",e.target.value),className:O.phone?"border-red-500":""}),O.phone&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:O.phone})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"role",children:"Role *"}),(0,l.jsxs)(d.l6,{value:U.role,onValueChange:e=>T("role",e),children:[(0,l.jsx)(d.bq,{children:(0,l.jsx)(d.yv,{placeholder:"Select role"})}),(0,l.jsxs)(d.gC,{children:[(0,l.jsx)(d.eb,{value:"Normal",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(j.A,{className:"h-4 w-4"}),"Normal User"]})}),(0,l.jsx)(d.eb,{value:"Admin",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(v.A,{className:"h-4 w-4"}),"Administrator"]})}),(0,l.jsx)(d.eb,{value:"CEO",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(N.A,{className:"h-4 w-4"}),"CEO"]})})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"locationId",children:"Assigned Location *"}),(0,l.jsxs)(d.l6,{value:U.locationId,onValueChange:e=>T("locationId",e),children:[(0,l.jsx)(d.bq,{className:O.locationId?"border-red-500":"",children:(0,l.jsx)(d.yv,{placeholder:"Select a location"})}),(0,l.jsx)(d.gC,{children:J?(0,l.jsx)(d.eb,{value:"loading",disabled:!0,children:"Loading locations..."}):E.length>0?E.map(e=>(0,l.jsx)(d.eb,{value:e.id,children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(g.A,{className:"h-4 w-4"}),e.name," - ",e.type]})},e.id)):(0,l.jsx)(d.eb,{value:"no-locations",disabled:!0,children:"No locations available"})})]}),O.locationId&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:O.locationId})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"avatar",children:"Avatar URL (Optional)"}),(0,l.jsx)(c.p,{id:"avatar",placeholder:"Enter avatar URL",value:U.avatar,onChange:e=>T("avatar",e.target.value)})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h4",{className:"font-medium",children:"Authentication"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"password",children:"Password *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(c.p,{id:"password",type:k?"text":"password",placeholder:"Enter password",value:U.password,onChange:e=>T("password",e.target.value),className:O.password?"border-red-500 pr-10":"pr-10"}),(0,l.jsx)(n.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>P(!k),children:k?(0,l.jsx)(w.A,{className:"h-4 w-4"}):(0,l.jsx)(f.A,{className:"h-4 w-4"})})]}),O.password&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:O.password}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 8 characters long"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"confirmPassword",children:"Confirm Password *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(c.p,{id:"confirmPassword",type:I?"text":"password",placeholder:"Confirm password",value:U.confirmPassword,onChange:e=>T("confirmPassword",e.target.value),className:O.confirmPassword?"border-red-500 pr-10":"pr-10"}),(0,l.jsx)(n.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>F(!I),children:I?(0,l.jsx)(w.A,{className:"h-4 w-4"}):(0,l.jsx)(f.A,{className:"h-4 w-4"})})]}),O.confirmPassword&&(0,l.jsx)("p",{className:"text-sm text-red-500",children:O.confirmPassword})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(h.d,{id:"isActive",checked:U.isActive,onCheckedChange:e=>T("isActive",e)}),(0,l.jsx)(o.J,{htmlFor:"isActive",children:"User is active"})]}),(0,l.jsxs)(m.Fc,{children:[(0,l.jsx)(p.A,{className:"h-4 w-4"}),(0,l.jsx)(m.TN,{children:"Users will receive an email with their login credentials. They can change their password after first login."})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-8 pt-6 border-t",children:[(0,l.jsxs)(n.$,{type:"button",variant:"outline",onClick:()=>e.push("/admin/users"),disabled:s,children:[(0,l.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,l.jsx)(n.$,{type:"submit",disabled:s,className:"min-w-[120px]",children:s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Create User"]})})]})]})]})})}},54041:(e,s,a)=>{Promise.resolve().then(a.bind(a,39444))},68854:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(71847).A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])}},e=>{e.O(0,[5239,3637,4127,2673,3437,8430,8441,1255,7358],()=>e(e.s=54041)),_N_E=e.O()}]);